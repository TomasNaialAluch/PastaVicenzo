(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84762,e=>{"use strict";var r=e.i(96243),s=e.i(47163);function a({className:e,...a}){return(0,r.jsx)("textarea",{"data-slot":"textarea",className:(0,s.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}e.s(["Textarea",()=>a])},94179,e=>{"use strict";var r=e.i(96243),s=e.i(42937),a=e.i(94237),t=e.i(47163);let i=(0,a.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:a,asChild:l=!1,...n}){let o=l?s.Slot:"span";return(0,r.jsx)(o,{"data-slot":"badge",className:(0,t.cn)(i({variant:a}),e),...n})}e.s(["Badge",()=>l])},20077,e=>{"use strict";var r=e.i(93221),s=e.i(55310);function a(e){let[a,t]=r.useState(void 0);return(0,s.useLayoutEffect)(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let s,a;if(!Array.isArray(r)||!r.length)return;let i=r[0];if("borderBoxSize"in i){let e=i.borderBoxSize,r=Array.isArray(e)?e[0]:e;s=r.inlineSize,a=r.blockSize}else s=e.offsetWidth,a=e.offsetHeight;t({width:s,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}t(void 0)},[e]),a}e.s(["useSize",()=>a])},27394,e=>{"use strict";var r=e.i(93221);function s(e){let s=r.useRef({value:e,previous:e});return r.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}e.s(["usePrevious",()=>s])},80913,e=>{"use strict";var r=e.i(93221),s=e.i(97723),a=e.i(45765),t=e.i(42937),i=e.i(96243);function l(e){let l=e+"CollectionProvider",[n,o]=(0,s.createContextScope)(l),[c,d]=n(l,{collectionRef:{current:null},itemMap:new Map}),u=e=>{let{scope:s,children:a}=e,t=r.default.useRef(null),l=r.default.useRef(new Map).current;return(0,i.jsx)(c,{scope:s,itemMap:l,collectionRef:t,children:a})};u.displayName=l;let m=e+"CollectionSlot",x=r.default.forwardRef((e,r)=>{let{scope:s,children:l}=e,n=d(m,s),o=(0,a.useComposedRefs)(r,n.collectionRef);return(0,i.jsx)(t.Slot,{ref:o,children:l})});x.displayName=m;let p=e+"CollectionItemSlot",g="data-radix-collection-item",h=r.default.forwardRef((e,s)=>{let{scope:l,children:n,...o}=e,c=r.default.useRef(null),u=(0,a.useComposedRefs)(s,c),m=d(p,l);return r.default.useEffect(()=>(m.itemMap.set(c,{ref:c,...o}),()=>void m.itemMap.delete(c))),(0,i.jsx)(t.Slot,{...{[g]:""},ref:u,children:n})});return h.displayName=p,[{Provider:u,Slot:x,ItemSlot:h},function(s){let a=d(e+"CollectionConsumer",s);return r.default.useCallback(()=>{let e=a.collectionRef.current;if(!e)return[];let r=Array.from(e.querySelectorAll(`[${g}]`));return Array.from(a.itemMap.values()).sort((e,s)=>r.indexOf(e.ref.current)-r.indexOf(s.ref.current))},[a.collectionRef,a.itemMap])},o]}e.s(["createCollection",()=>l])},43028,64347,e=>{"use strict";let r=(0,e.i(10965).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["default",()=>r],64347),e.s(["ChevronDownIcon",()=>r],43028)},5576,e=>{"use strict";let r=(0,e.i(10965).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>r],5576)},93134,e=>{"use strict";let r=(0,e.i(10965).default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["default",()=>r])},81261,e=>{"use strict";let r=(0,e.i(10965).default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>r],81261)},11741,e=>{"use strict";let r=(0,e.i(10965).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>r],11741)},78665,e=>{"use strict";var r=e.i(96243),s=e.i(93221),a=e.i(70065),t=e.i(67881),i=e.i(23750),l=e.i(10708),n=e.i(84762),o=e.i(94179),c=e.i(30374),d=e.i(62870),u=e.i(45765),m=e.i(97723),x=e.i(78896),p=e.i(19984),g=e.i(27394),h=e.i(20077),v=e.i(13311),f=e.i(70312),j="Checkbox",[b,y]=(0,m.createContextScope)(j),[N,P]=b(j),C=s.forwardRef((e,a)=>{let{__scopeCheckbox:t,name:i,checked:l,defaultChecked:n,required:o,disabled:c,value:d="on",onCheckedChange:m,form:g,...h}=e,[v,j]=s.useState(null),b=(0,u.useComposedRefs)(a,e=>j(e)),y=s.useRef(!1),P=!v||g||!!v.closest("form"),[C=!1,k]=(0,p.useControllableState)({prop:l,defaultProp:n,onChange:m}),w=s.useRef(C);return s.useEffect(()=>{let e=v?.form;if(e){let r=()=>k(w.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[v,k]),(0,r.jsxs)(N,{scope:t,state:C,disabled:c,children:[(0,r.jsx)(f.Primitive.button,{type:"button",role:"checkbox","aria-checked":E(C)?"mixed":C,"aria-required":o,"data-state":F(C),"data-disabled":c?"":void 0,disabled:c,value:d,...h,ref:b,onKeyDown:(0,x.composeEventHandlers)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,x.composeEventHandlers)(e.onClick,e=>{k(e=>!!E(e)||!e),P&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})}),P&&(0,r.jsx)(S,{control:v,bubbles:!y.current,name:i,value:d,checked:C,required:o,disabled:c,form:g,style:{transform:"translateX(-100%)"},defaultChecked:!E(n)&&n})]})});C.displayName=j;var k="CheckboxIndicator",w=s.forwardRef((e,s)=>{let{__scopeCheckbox:a,forceMount:t,...i}=e,l=P(k,a);return(0,r.jsx)(v.Presence,{present:t||E(l.state)||!0===l.state,children:(0,r.jsx)(f.Primitive.span,{"data-state":F(l.state),"data-disabled":l.disabled?"":void 0,...i,ref:s,style:{pointerEvents:"none",...e.style}})})});w.displayName=k;var S=e=>{let{control:a,checked:t,bubbles:i=!0,defaultChecked:l,...n}=e,o=s.useRef(null),c=(0,g.usePrevious)(t),d=(0,h.useSize)(a);s.useEffect(()=>{let e=o.current,r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==t&&r){let s=new Event("click",{bubbles:i});e.indeterminate=E(t),r.call(e,!E(t)&&t),e.dispatchEvent(s)}},[c,t,i]);let u=s.useRef(!E(t)&&t);return(0,r.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:l??u.current,...n,tabIndex:-1,ref:o,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function E(e){return"indeterminate"===e}function F(e){return E(e)?"indeterminate":e?"checked":"unchecked"}var L=e.i(49894),A=e.i(47163);function D({className:e,...s}){return(0,r.jsx)(C,{"data-slot":"checkbox",className:(0,A.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:(0,r.jsx)(w,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,r.jsx)(L.CheckIcon,{className:"size-3.5"})})})}var R=e.i(5576),V=e.i(29439),B=e.i(81261),I=e.i(11741),T=e.i(74872),z=e.i(93134),z=z,q=e.i(34290);let M=(0,e.i(10965).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var G=e.i(48054),H=e.i(45041);e.i(11429);var $=e.i(75985),O=e.i(76009);e.i(68063);var U=e.i(93286),K=e.i(22036),W=e.i(9436),X=e.i(91432),_=e.i(34922);let Q=[{id:"rellenas",label:"Pastas Rellenas"},{id:"cintas",label:"Cintas"},{id:"placas",label:"Placas"},{id:"especiales",label:"Especiales"},{id:"noqui",label:"Ñoqui"}];function J(){let{user:e}=(0,X.useAuth)(),{isAdmin:u}=(0,_.useIsAdmin)(),[m,x]=(0,s.useState)([]),[p,g]=(0,s.useState)(!0),[h,v]=(0,s.useState)(""),[f,j]=(0,s.useState)("all"),[b,y]=(0,s.useState)(!1),[N,P]=(0,s.useState)(null),{openModal:C}=(0,W.useConfirmModal)(),[k,w]=(0,s.useState)({name:"",description:"",price:"",image:"",category:"rellenas",isVeggie:!1,isGlutenFree:!1,isPromo:!1,isActive:!0,unitsPerPackage:"",servesPeople:"",variants:[]}),[S,E]=(0,s.useState)(""),[F,L]=(0,s.useState)(""),[A,J]=(0,s.useState)(null),[Y,Z]=(0,s.useState)(""),[ee,er]=(0,s.useState)(!1);(0,s.useEffect)(()=>{es()},[]);let es=async()=>{try{let e;g(!0);let r=(0,$.collection)(O.db,"products");try{let s=(0,$.query)(r,(0,$.orderBy)("name"));e=await (0,$.getDocs)(s)}catch(s){console.warn("Query con orderBy falló, cargando sin orden:",s),e=await (0,$.getDocs)(r)}let s=[];e.forEach(e=>{let r=e.data();s.push({id:e.id,name:r.name||"",description:r.description||"",price:"number"==typeof r.price?r.price:parseFloat(r.price)||0,image:r.image||"",category:r.category||"rellenas",isVeggie:r.isVeggie||!1,isGlutenFree:r.isGlutenFree||!1,isPromo:r.isPromo||!1,isActive:void 0===r.isActive||r.isActive,unitsPerPackage:r.unitsPerPackage?Number(r.unitsPerPackage):void 0,servesPeople:r.servesPeople?Number(r.servesPeople):void 0,variants:r.variants||[]})}),s.sort((e,r)=>e.name.localeCompare(r.name)),x(s)}catch(e){console.error("Error cargando productos:",e),x([])}finally{g(!1)}},ea=e=>{e?(P(e),w({name:e.name,description:e.description,price:e.price.toString(),image:e.image,category:e.category,isVeggie:e.isVeggie||!1,isGlutenFree:e.isGlutenFree||!1,isPromo:e.isPromo||!1,isActive:void 0===e.isActive||e.isActive,unitsPerPackage:e.unitsPerPackage?.toString()||"",servesPeople:e.servesPeople?.toString()||"",variants:e.variants||[]}),J(null),Z(e.image)):(P(null),w({name:"",description:"",price:"",image:"",category:"rellenas",isVeggie:!1,isGlutenFree:!1,isPromo:!1,isActive:!0,unitsPerPackage:"",servesPeople:"",variants:[]}),J(null),Z("")),y(!0)},et=async(e,r)=>{let s=r?`products/${r}_${Date.now()}_${e.name}`:`products/${Date.now()}_${e.name}`,a=(0,U.ref)(O.storage,s);return await (0,U.uploadBytes)(a,e),await (0,U.getDownloadURL)(a)},ei=async()=>{try{if(!u)return void K.toast.error("No tenés permisos para crear productos. Verificá que tu usuario tenga role: 'admin' en Firestore.");if(!k.name||!k.price)return void K.toast.error("Completá nombre y precio (campos obligatorios)");if(!A&&!k.image)return void K.toast.error("Subí una imagen o ingresá una URL de imagen");let e=k.image;if(A){er(!0);try{e=await et(A,N?.id),K.toast.success("Imagen subida correctamente")}catch(e){console.error("Error subiendo imagen:",e),e instanceof Error?K.toast.error(`Error al subir la imagen: ${e.message}`):K.toast.error("Error al subir la imagen. Intentá nuevamente."),er(!1);return}finally{er(!1)}}let r={name:k.name,description:k.description,price:parseFloat(k.price),image:e,category:k.category,isVeggie:k.isVeggie,isGlutenFree:k.isGlutenFree,isPromo:k.isPromo,isActive:void 0===k.isActive||k.isActive};if("rellenas"===k.category&&k.unitsPerPackage&&""!==k.unitsPerPackage.trim()&&(r.unitsPerPackage=parseInt(k.unitsPerPackage)),"noqui"===k.category&&k.servesPeople&&""!==k.servesPeople.trim()&&(r.servesPeople=parseInt(k.servesPeople)),k.variants&&k.variants.length>0?r.variants=k.variants:r.variants=[],N){let e=(0,$.doc)(O.db,"products",N.id);await (0,$.updateDoc)(e,r),K.toast.success("Producto actualizado correctamente")}else await (0,$.addDoc)((0,$.collection)(O.db,"products"),r),K.toast.success("Producto creado correctamente");y(!1),J(null),Z(""),es()}catch(e){console.error("Error guardando producto:",e),e instanceof Error?e.message.includes("permission")||e.message.includes("Permission")?K.toast.error("No tenés permisos para crear productos. Verificá que tu usuario tenga role: 'admin' en Firestore."):e.message.includes("Missing or insufficient")?K.toast.error("Permisos insuficientes. Verificá que tu usuario tenga role: 'admin' en Firestore."):K.toast.error(`Error al guardar el producto: ${e.message}`):K.toast.error("Error al guardar el producto. Revisá la consola para más detalles.")}},el=m.filter(e=>{let r=""===h||e.name.toLowerCase().includes(h.toLowerCase())||e.description.toLowerCase().includes(h.toLowerCase()),s="all"===f||e.category===f;return r&&s});return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"font-serif text-2xl font-bold text-primary mb-2",children:"Gestión de Productos"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Creá, editá y eliminá productos del catálogo"})]}),(0,r.jsxs)(c.Dialog,{open:b,onOpenChange:y,children:[(0,r.jsx)(c.DialogTrigger,{asChild:!0,children:(0,r.jsxs)(t.Button,{onClick:()=>ea(),children:[(0,r.jsx)(V.Plus,{className:"h-4 w-4 mr-2"}),"Nuevo Producto"]})}),(0,r.jsxs)(c.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)(c.DialogHeader,{children:[(0,r.jsx)(c.DialogTitle,{children:N?"Editar Producto":"Nuevo Producto"}),(0,r.jsx)(c.DialogDescription,{children:N?"Modificá los datos del producto":"Completá los datos del nuevo producto"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{htmlFor:"name",children:"Nombre del Producto *"}),(0,r.jsx)(i.Input,{id:"name",value:k.name,onChange:e=>w({...k,name:e.target.value}),placeholder:"Ej: Ravioles de Ricota"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{htmlFor:"category",children:"Categoría"}),(0,r.jsxs)(d.Select,{value:k.category,onValueChange:e=>{w({...k,category:e,unitsPerPackage:"rellenas"!==e?"":k.unitsPerPackage,servesPeople:"noqui"!==e?"":k.servesPeople})},children:[(0,r.jsx)(d.SelectTrigger,{children:(0,r.jsx)(d.SelectValue,{})}),(0,r.jsx)(d.SelectContent,{children:Q.map(e=>(0,r.jsx)(d.SelectItem,{value:e.id,children:e.label},e.id))})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{htmlFor:"description",children:"Descripción"}),(0,r.jsx)(n.Textarea,{id:"description",value:k.description,onChange:e=>w({...k,description:e.target.value}),placeholder:"Descripción breve del producto (ingredientes, recomendaciones...)",rows:2})]})]}),(0,r.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 bg-muted/20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-primary font-medium border-b pb-2",children:[(0,r.jsx)(M,{className:"h-4 w-4"}),(0,r.jsx)("h3",{children:"Precios y Opciones"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{htmlFor:"price",children:"Precio Base (o Precio Único) *"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-muted-foreground font-bold",children:"$"}),(0,r.jsx)(i.Input,{id:"price",type:"number",value:k.price,onChange:e=>w({...k,price:e.target.value}),placeholder:"Ej: 1200",className:"max-w-[200px]"})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:k.variants.length>0?"Este precio se mostrará como referencia 'desde' si hay variantes.":"Este es el precio final del producto si no agregás variantes."})]}),(0,r.jsxs)("div",{className:"space-y-3 pt-2 border-t",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(l.Label,{className:"text-sm",children:"Variantes / Porciones (Opcional)"}),(0,r.jsxs)(o.Badge,{variant:"outline",className:"font-normal",children:[k.variants.length," opciones activas"]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:'Usá esto para ofrecer diferentes tamaños o cantidades (ej: "2 Porciones" y "4 Porciones"). Los clientes elegirán una de estas opciones al comprar.'}),(0,r.jsxs)("div",{className:"flex gap-2 items-end bg-background p-3 rounded border",children:[(0,r.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,r.jsx)(l.Label,{htmlFor:"variantLabel",className:"text-xs",children:"Nombre de la opción"}),(0,r.jsx)(i.Input,{id:"variantLabel",placeholder:"Ej: 4 Porciones",value:S,onChange:e=>E(e.target.value),className:"h-8"})]}),(0,r.jsxs)("div",{className:"w-28 space-y-1",children:[(0,r.jsx)(l.Label,{htmlFor:"variantPrice",className:"text-xs",children:"Precio"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"$"}),(0,r.jsx)(i.Input,{id:"variantPrice",type:"number",placeholder:"2000",value:F,onChange:e=>L(e.target.value),className:"h-8 pl-5"})]})]}),(0,r.jsxs)(t.Button,{type:"button",onClick:()=>{if(!S||!F)return void K.toast.error("Completá nombre y precio de la variante");let e={id:Date.now().toString(),label:S,price:parseFloat(F)};w({...k,variants:[...k.variants,e]}),E(""),L("")},size:"sm",variant:"secondary",className:"h-8",children:[(0,r.jsx)(V.Plus,{className:"h-4 w-4 mr-1"})," Agregar"]})]}),k.variants.length>0&&(0,r.jsx)("div",{className:"grid gap-2",children:k.variants.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between bg-white p-2 rounded border shadow-sm text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(G.Package,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"font-medium",children:e.label})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:"font-bold text-green-600",children:["$",e.price]}),(0,r.jsx)(t.Button,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:bg-destructive/10 hover:text-destructive",onClick:()=>{var r;return r=e.id,void w({...k,variants:k.variants.filter(e=>e.id!==r)})},children:(0,r.jsx)(q.X,{className:"h-4 w-4"})})]})]},e.id))})]})]})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{htmlFor:"image",children:"Imagen del Producto *"}),(0,r.jsxs)("div",{className:"space-y-3 border rounded-lg p-3",children:[Y||k.image?(0,r.jsxs)("div",{className:"relative h-40 w-full rounded-md overflow-hidden bg-muted border",children:[(0,r.jsx)(H.default,{src:Y||k.image,alt:"Preview",fill:!0,className:"object-cover"}),(0,r.jsx)(t.Button,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:()=>{J(null),Z(""),w({...k,image:""})},children:(0,r.jsx)(q.X,{className:"h-4 w-4"})}),ee&&(0,r.jsx)("div",{className:"absolute inset-0 bg-background/80 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Subiendo..."})]})})]}):(0,r.jsxs)("div",{className:"h-40 w-full bg-muted/50 border-2 border-dashed rounded-md flex flex-col items-center justify-center text-muted-foreground",children:[(0,r.jsx)(z.default,{className:"h-8 w-8 mb-2 opacity-50"}),(0,r.jsx)("span",{className:"text-xs",children:"Sin imagen seleccionada"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(l.Label,{htmlFor:"imageFile",className:"sr-only",children:"Subir archivo"}),(0,r.jsx)(i.Input,{id:"imageFile",type:"file",accept:"image/*",onChange:e=>{let r=e.target.files?.[0];if(r){if(!r.type.startsWith("image/"))return void K.toast.error("Por favor seleccioná un archivo de imagen válido");if(r.size>5242880)return void K.toast.error("La imagen es demasiado grande. Máximo 5MB");J(r);let e=new FileReader;e.onloadend=()=>{Z(e.result)},e.readAsDataURL(r),w({...k,image:""})}},disabled:ee,className:"cursor-pointer text-xs"})]}),(0,r.jsxs)("div",{className:"relative flex items-center py-1",children:[(0,r.jsx)("span",{className:"w-full border-t"}),(0,r.jsx)("span",{className:"px-2 text-xs text-muted-foreground uppercase bg-background",children:"O URL"}),(0,r.jsx)("span",{className:"w-full border-t"})]}),(0,r.jsx)(i.Input,{id:"imageUrl",value:k.image,onChange:e=>{w({...k,image:e.target.value}),e.target.value&&(J(null),Z(e.target.value))},placeholder:"https://...",disabled:!!A||ee,className:"text-xs h-8"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{children:"Detalles Específicos"}),(0,r.jsx)("div",{className:"p-3 bg-muted/30 rounded-lg border min-h-[100px]",children:"rellenas"===k.category?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{htmlFor:"unitsPerPackage",className:"text-xs",children:"Unidades por Paquete"}),(0,r.jsx)(i.Input,{id:"unitsPerPackage",type:"number",min:"1",value:k.unitsPerPackage,onChange:e=>w({...k,unitsPerPackage:e.target.value}),placeholder:"Ej: 12",className:"bg-background"}),(0,r.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"Cantidad de unidades que trae cada paquete/caja"})]}):(0,r.jsx)("p",{className:"text-sm text-muted-foreground flex items-center h-full justify-center italic",children:"No hay campos extra para esta categoría."})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{children:"Configuración"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-2 p-3 bg-muted/30 rounded-lg border",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(D,{id:"isActive",checked:k.isActive,onCheckedChange:e=>w({...k,isActive:!!e})}),(0,r.jsx)(l.Label,{htmlFor:"isActive",className:"cursor-pointer text-sm",children:"Visible en Tienda"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(D,{id:"isPromo",checked:k.isPromo,onCheckedChange:e=>w({...k,isPromo:!!e})}),(0,r.jsx)(l.Label,{htmlFor:"isPromo",className:"cursor-pointer text-sm",children:"En Promoción"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(D,{id:"isVeggie",checked:k.isVeggie,onCheckedChange:e=>w({...k,isVeggie:!!e})}),(0,r.jsx)(l.Label,{htmlFor:"isVeggie",className:"cursor-pointer text-sm",children:"Vegetariano"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(D,{id:"isGlutenFree",checked:k.isGlutenFree,onCheckedChange:e=>w({...k,isGlutenFree:!!e})}),(0,r.jsx)(l.Label,{htmlFor:"isGlutenFree",className:"cursor-pointer text-sm",children:"Sin Gluten"})]})]})]})]})]})]}),(0,r.jsxs)(c.DialogFooter,{children:[(0,r.jsx)(t.Button,{variant:"outline",onClick:()=>y(!1),children:"Cancelar"}),(0,r.jsx)(t.Button,{onClick:ei,children:N?"Actualizar":"Crear"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)(R.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(i.Input,{placeholder:"Buscar productos...",value:h,onChange:e=>v(e.target.value),className:"pl-10"})]}),(0,r.jsxs)(d.Select,{value:f,onValueChange:j,children:[(0,r.jsx)(d.SelectTrigger,{className:"w-full sm:w-[180px]",children:(0,r.jsx)(d.SelectValue,{placeholder:"Filtrar por categoría"})}),(0,r.jsxs)(d.SelectContent,{children:[(0,r.jsx)(d.SelectItem,{value:"all",children:"Todas las categorías"}),Q.map(e=>(0,r.jsx)(d.SelectItem,{value:e.id,children:e.label},e.id))]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsx)(a.Card,{children:(0,r.jsxs)(a.CardHeader,{className:"pb-2",children:[(0,r.jsx)(a.CardDescription,{children:"Total Productos"}),(0,r.jsx)(a.CardTitle,{className:"text-2xl",children:m.length})]})}),(0,r.jsx)(a.Card,{children:(0,r.jsxs)(a.CardHeader,{className:"pb-2",children:[(0,r.jsx)(a.CardDescription,{children:"Activos"}),(0,r.jsx)(a.CardTitle,{className:"text-2xl text-green-600",children:m.filter(e=>!1!==e.isActive).length})]})}),(0,r.jsx)(a.Card,{children:(0,r.jsxs)(a.CardHeader,{className:"pb-2",children:[(0,r.jsx)(a.CardDescription,{children:"En Promoción"}),(0,r.jsx)(a.CardTitle,{className:"text-2xl text-blue-600",children:m.filter(e=>e.isPromo).length})]})}),(0,r.jsx)(a.Card,{children:(0,r.jsxs)(a.CardHeader,{className:"pb-2",children:[(0,r.jsx)(a.CardDescription,{children:"Vegetarianos"}),(0,r.jsx)(a.CardTitle,{className:"text-2xl text-green-600",children:m.filter(e=>e.isVeggie).length})]})})]}),p?(0,r.jsx)(a.Card,{children:(0,r.jsx)(a.CardContent,{className:"py-12 text-center",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"Cargando productos..."})})}):0===el.length?(0,r.jsx)(a.Card,{children:(0,r.jsxs)(a.CardContent,{className:"py-12 text-center",children:[(0,r.jsx)(T.ShoppingBag,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-50"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:h||"all"!==f?"No se encontraron productos con estos filtros.":"Aún no hay productos. Creá el primero!"}),!h&&"all"===f&&(0,r.jsxs)(t.Button,{onClick:()=>ea(),children:[(0,r.jsx)(V.Plus,{className:"h-4 w-4 mr-2"}),"Crear Primer Producto"]})]})}):(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:el.map(e=>(0,r.jsxs)(a.Card,{className:!1===e.isActive?"opacity-60":"",children:[(0,r.jsxs)("div",{className:"relative h-48 w-full",children:[(0,r.jsx)(H.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover rounded-t-lg"}),(0,r.jsxs)("div",{className:"absolute top-2 right-2 flex gap-1",children:[e.isPromo&&(0,r.jsx)(o.Badge,{className:"bg-red-500",children:"Promo"}),e.isVeggie&&(0,r.jsx)(o.Badge,{className:"bg-green-500",children:"Veggie"}),e.isGlutenFree&&(0,r.jsx)(o.Badge,{className:"bg-blue-500",children:"Sin Gluten"}),!1===e.isActive&&(0,r.jsx)(o.Badge,{variant:"outline",children:"Inactivo"})]})]}),(0,r.jsxs)(a.CardHeader,{children:[(0,r.jsx)(a.CardTitle,{children:e.name}),(0,r.jsx)(a.CardDescription,{className:"line-clamp-2",children:e.description})]}),(0,r.jsxs)(a.CardContent,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("span",{className:"text-2xl font-bold text-primary",children:["$",e.price.toLocaleString("es-AR")]}),(0,r.jsx)(o.Badge,{variant:"outline",children:Q.find(r=>r.id===e.category)?.label})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(t.Button,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>ea(e),children:[(0,r.jsx)(B.Pencil,{className:"h-4 w-4 mr-1"}),"Editar"]}),(0,r.jsx)(t.Button,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>{var r,s;return r=e.id,s=e.name,void C({title:"¿Eliminar producto?",description:`\xbfEst\xe1s seguro de que quer\xe9s eliminar "${s}"? Esta acci\xf3n no se puede deshacer.`,actionLabel:"Sí, eliminar",variant:"destructive",onConfirm:async()=>{try{await (0,$.deleteDoc)((0,$.doc)(O.db,"products",r)),K.toast.success("Producto eliminado correctamente"),es()}catch(e){console.error("Error eliminando producto:",e),K.toast.error("Error al eliminar el producto")}}})},children:(0,r.jsx)(I.Trash2,{className:"h-4 w-4"})})]})]})]},e.id))})]})}e.s(["default",()=>J],78665)}]);